# Production Training Configuration v1
# =====================================
#
# This configuration documents the training setup used to produce
# models/production/glaucoma_efficientnet_b0_v1.pt
#
# Performance (Hospital-Based Split):
#   - Test AUC: 93.7%
#   - Test Accuracy: 76.5%
#   - Test Sensitivity: 74.4%
#   - Test Specificity: 91.7%

model:
  backbone: efficientnet_b0
  library: timm  # NOT torchvision - important for weight loading
  pretrained: true  # ImageNet pretrained
  dropout: 0.3
  num_classes: 2
  classes:
    - normal
    - glaucoma
  global_pool: avg  # Returns (B, 1280) features directly

training:
  optimizer: adamw
  lr: 0.0001
  weight_decay: 0.01
  scheduler: cosine_warmup
  warmup_epochs: 3
  epochs: 30
  batch_size: 32
  early_stopping: false

data:
  dataset: rimone
  input_size: 224
  normalization: imagenet  # mean=[0.485, 0.456, 0.406], std=[0.229, 0.224, 0.225]

  # Hospital-based splitting prevents data leakage
  splitting_strategy: hospital_based
  test_hospitals:
    - r1
  train_val_hospitals:
    - r2
    - r3

  # Dataset statistics
  total_images: 485
  train_images: 330
  val_images: 57
  test_images: 98

  class_distribution:
    glaucoma: 172
    normal: 313

augmentation:
  # Training augmentations
  horizontal_flip: true
  vertical_flip: false
  rotation_degrees: 15
  color_jitter:
    brightness: 0.2
    contrast: 0.2
    saturation: 0.1
    hue: 0.05

results:
  best_epoch: 29
  best_val_auc: 0.9875

  test_metrics:
    loss: 0.4626
    accuracy: 0.765
    sensitivity: 0.744
    specificity: 0.917
    auc_roc: 0.937

output:
  checkpoint: models/production/glaucoma_efficientnet_b0_v1.pt
  history: models/production/training_history_v1.json
  metadata: models/production/dataset_metadata_v1.json
